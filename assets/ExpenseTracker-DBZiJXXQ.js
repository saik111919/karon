import{r as u,u as f,G as j,P as s,j as e,c as y,d as N,e as w,D as v}from"./index-BJkg56xC.js";const T=()=>{const[r,d]=u.useState([]),[n,a]=f(!1),l=u.useCallback(async()=>{n(!0);try{const i=await j(),{data:h}=i;d(h)}catch(i){console.error("Failed to fetch transactions:",i)}finally{n(!1)}},[n]);return u.useEffect(()=>{l()},[l]),{data:r,LoaderComp:a,setLoader:n,fetchTransactions:l}},m=({children:r,tooltip:d})=>e.jsxs("div",{className:"relative group",children:[e.jsx("span",{className:"truncate",children:r}),e.jsx("div",{className:"absolute hidden group-hover:block bg-gray-800 top-full text-white text-xs rounded p-2 -mt-6 left-1/2 transform -translate-x-1/2 whitespace-nowrap z-auto",children:d})]});m.propTypes={children:s.node.isRequired,tooltip:s.string.isRequired};function D(r){return y({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M19.045 7.401c.378-.378.586-.88.586-1.414s-.208-1.036-.586-1.414l-1.586-1.586c-.378-.378-.88-.586-1.414-.586s-1.036.208-1.413.585L4 13.585V18h4.413L19.045 7.401zm-3-3 1.587 1.585-1.59 1.584-1.586-1.585 1.589-1.584zM6 16v-1.585l7.04-7.018 1.586 1.586L7.587 16H6zm-2 4h16v2H4z"},child:[]}]})(r)}const b=({data:r,onDeleteExpense:d})=>{const n=()=>{const t=new Date,p=t.getFullYear(),g=t.getMonth()+1;return`${p}-${g}`},[a,l]=u.useState(n()),[i,h]=u.useState(""),c=r.find(t=>t.monthYear===a)||{transactions:[]},o=Array.from(new Set(c.transactions.map(t=>new Date(t.createdAt).getDate()))).sort((t,p)=>t-p),x=i?c.transactions.filter(t=>new Date(t.createdAt).getDate()===parseInt(i,10)):c.transactions;return u.useEffect(()=>{h("")},[a]),e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex mb-4 justify-between",children:[e.jsx("input",{type:"month",className:"bg-inherit border border-inherit rounded-md p-2",value:a.length===6?`${a.slice(0,5)}0${a.slice(5)}`:a,onChange:t=>l(t.target.value.length===7?t.target.value.replace("-0","-"):t.target.value)}),o.length>1&&o.length>0&&e.jsxs("select",{className:"bg-inherit border border-inherit rounded-md p-2 ml-4",value:i,onChange:t=>h(t.target.value),children:[e.jsx("option",{value:"",className:"bg-inherit text-inherit",children:"All Days"}),o.map(t=>e.jsx("option",{value:t,className:"bg-inherit text-inherit",children:t},t))]})]}),x.length===0?e.jsx("p",{className:"text-inherit text-center",children:"No data available for the selected date."}):e.jsx("div",{className:" h-96 overflow-y-auto",children:e.jsxs("table",{className:"min-w-full bg-inherit border border-inherit rounded-md",children:[e.jsx("thead",{className:"sticky top-0 bg-inherit",children:e.jsxs("tr",{className:"bg-black text-white ",children:[e.jsx("th",{className:"py-2 px-2 text-start border-b",children:"Title"}),e.jsx("th",{className:"py-2 px-2 text-start border-b",children:"Amount"}),e.jsx("th",{className:"py-2 px-2 text-start border-b",children:"Type"}),e.jsx("th",{className:"py-2 px-2 text-start border-b",children:"Action"})]})}),e.jsx("tbody",{children:x.map(t=>e.jsxs("tr",{children:[e.jsx("td",{className:"py-2 px-2 text-start border-b max-w-20 truncate overflow-x-auto",children:e.jsx(m,{tooltip:t.title,children:t.title})}),e.jsx("td",{className:"py-2 px-2 text-start border-b",children:t.amount}),e.jsx("td",{className:"py-2 px-2 text-start border-b",children:t.type}),e.jsxs("td",{className:"py-2 px-2 text-start border-b",children:[e.jsx("button",{className:"p-2 bg-blue-500 text-white rounded hover:bg-blue-600 transition duration-200 disabled:bg-slate-500",disabled:!0,onClick:()=>{console.log(t._id)},children:e.jsx(D,{className:"w-5 h-5"})}),e.jsx("button",{className:"p-2 ml-2 bg-red-500 text-white rounded hover:bg-red-600 transition duration-200",onClick:()=>{d(t._id)},children:e.jsx(N,{className:"w-5 h-5"})})]})]},t._id))})]})})]})};b.propTypes={onDeleteExpense:s.func.isRequired,data:s.arrayOf(s.shape({monthYear:s.string.isRequired,transactions:s.arrayOf(s.shape({_id:s.string.isRequired,createdAt:s.string.isRequired,type:s.string.isRequired,amount:s.number.isRequired,title:s.string.isRequired})).isRequired,totalCredited:s.number,totalSpent:s.number,remainingAmount:s.number})).isRequired};const R=()=>{const{data:r,LoaderComp:d,setLoader:n,fetchTransactions:a}=T(),{showToast:l}=w();function i(c){n(!0),v(c).then(({data:o})=>{a(),l(o.message,"info")}).catch(o=>{var x;l(((x=o==null?void 0:o.data)==null?void 0:x.message)||"Error Ocured.","error")}).finally(()=>{n(!1)})}const h=c=>{window.confirm("Are you sure you want to delete this expense?")&&i(c)};return e.jsxs(e.Fragment,{children:[e.jsx(d,{}),"ExpenseTracker",e.jsx(b,{data:r,onDeleteExpense:h})]})};export{R as default};
